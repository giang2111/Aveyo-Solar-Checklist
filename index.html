<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AVEYO Solar Checklist</title>
    <link rel="icon" href="aveyologo.png" type="image/x-icon">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;600&display=swap">
    <style>
        body {
            font-family: 'Lexend', Arial, sans-serif;
            margin: 20px;
            transition: background-color 0.3s, color 0.3s;
        }
        .checklist, .fixed-checklist {
            background-color: #ffffe0;
            border-top: 2px solid #000;
            padding-top: 10px;
            margin-top: 20px;
        }
        .checklist-item {
            margin-bottom: 10px;
            list-style-type: none;
            padding-left: 0;
            cursor: pointer;
        }
        .sub-items {
            padding-left: 20px;
            margin-top: 5px;
            display: none;
        }
        .sub-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .sub-item input[type="checkbox"] {
            margin-right: 10px;
            appearance: none;
            width: 12px;
            height: 12px;
            border: 2px solid #000;
            border-radius: 50%;
            position: relative;
            vertical-align: middle;
        }
        .sub-item input[type="checkbox"]:checked::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 6px;
            height: 6px;
            background-color: #000;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }
        .preferences-box {
            background-color: #ffffe0;
            padding: 20px;
            border-radius: 5px;
            margin-top: 20px;
            border-top: 2px solid #000;
        }
        .preferences {
            border-top: 2px solid #000;
            padding-top: 10px;
            margin-top: 20px;
        }
        .preferences ul {
            padding-left: 20px;
            margin: 0;
        }
        .preferences li {
            line-height: 2em;
            margin-bottom: 5px;
            list-style-type: disc;
        }
        .preferences li ul {
            margin-top: 5px;
            padding-left: 20px;
        }
        .light-mode {
            background-color: #ffffff;
            color: #000000;
        }
        .light-mode .checklist, .light-mode .fixed-checklist, .light-mode .preferences {
            border-color: #000000;
        }
        .dark-mode {
            background-color: #1e1e1e;
            color: #e0e0e0;
        }
        .dark-mode .checklist, .dark-mode .fixed-checklist, .dark-mode .preferences {
            border-color: #e0e0e0;
        }
        .dark-mode .checklist, .dark-mode .fixed-checklist, .dark-mode .preferences-box {
            background-color: transparent;
        }
        .dark-mode .sub-item input[type="checkbox"] {
            border-color: #e0e0e0;
        }
        .dark-mode .sub-item input[type="checkbox"]:checked::before {
            background-color: #e0e0e0;
        }
        .logo-container {
            display: flex;
            align-items: center;
        }
        .logo-container img {
            height: 40px;
            margin-right: 10px;
        }
        .preferences-logo {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        .preferences-logo img {
            height: 30px;
            margin-right: 10px;
        }
        .dropdown-container {
            margin-bottom: 20px;
        }
        .dropdown-container select {
            padding: 5px;
            font-size: 16px;
            margin-right: 10px;
        }
        .theme-toggle {
            margin-bottom: 20px;
        }
        .theme-toggle button {
            padding: 10px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            background-color: #000;
            color: #fff;
            border-radius: 5px;
        }
        .theme-toggle button.light-mode-btn {
            background-color: #fff;
            color: #000;
            border: 1px solid #000;
        }
        .checkbox-list-container {
            margin-top: 20px;
            display: flex;
            gap: 20px;
        }
        .checkbox-list-container label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 16px;
        }
        .checkbox-list-container input[type="checkbox"] {
            margin: 0;
        }
        .green-highlight {
    color: green;
    font-weight: bold;
}

    </style>
</head>
<body class="light-mode">

<div class="theme-toggle">
    <button id="toggle-theme" class="light-mode-btn">Dark Mode</button>
</div>

<div class="fixed-checklist">
    <div class="logo-container">
        <img src="aveyologo.png" alt="AVEYO Logo">
        <h3>AVEYO Solar Checklist:</h3>
    </div>
    <div class="dropdown-container">
        <select id="state-dropdown">
            <option value="">Select State</option>
            <option value="California">California</option>
            <option value="Texas">Texas</option>
            <option value="Illinois">Illinois</option>
        </select>
        <select id="ahj-dropdown">
            <option value="">Select AHJ</option>
        </select>
        <select id="utility-dropdown">
            <option value="">Select Utility</option>
        </select>
    </div>
    <div class="checkbox-list-container">
        <label><input type="checkbox" id="trenching"> Trenching</label>
        <label><input type="checkbox" id="ground-mount"> Ground mount</label>
        <label><input type="checkbox" id="de-rate"> De-rate</label>
    </div>
    <ul id="fixed-checklist-list"></ul>
</div>

<div class="preferences-box">
    <div class="preferences-logo">
        <img src="aveyologo.png" alt="AVEYO Logo">
        <h3>AVEYO Design Preferences:</h3>
    </div>
    <div class="preferences">
        <ul>
            <li>Review SS while doing the design.</li>
            <li>If we are missing SS photos, reach out to Tayler to see if we can avoid a Truck Roll.</li>
            <li>Open Scanifly and match placement of panels with sold design. Download DWG.</li>
            <li>Open AHJ database to ensure we are designing plans to all specific requirements.</li>
            <li>Design in AutoCAD and Fill out Excel information with all customer information.</li>
            <li>Send to Tayler for QA he will then request for Stamps if plans look accurate.</li>
            <li>Automatic Upgrades:
                <ul id="automatic-upgrades-list"></ul>
            </li>
        </ul>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const itemTexts = {
            "COVER SHEET ▽": ["Correct Homeowner Name",
                            "Correct Utility",
                            "Correct AHJ",
                            "Correct Homeowner Address",
                            "Correct Codes and Standards",
                            "Correct Electrical Equipment",
                            "Correct Racking Information",
                        ],
            "SITE PLAN ▽": ["Prioritize Portrait Orientation",
                          "PV Array matches DXF file",
                          "Driveway and Fence Shown (If Applicable)",
                          "Correct Fire Setbacks Shown",
                          "Frontage Road Shown",
                          "Property Line Dimensioned",
                          "Legend Accurate",
                          "Junction Box Shown",
                          "Mounting Plane Shown",
                          "Correct Array Details",
                          "Correct Equipment Location",
                          ],
            "ROOF PLAN ▽": ["Verify Equipment Information", 
                          "Accurate Equipment Quantities",
                          "Correct Roof Info",
                          "Attachment Legend Shown",
                          "Setbacks and Attachment spacing Dimensioned",
                        ],
            "MOUNTING DETAIL ▽": ["Verify the correct DWG matches the called out attachment"],
            "LINE DIAGRAM ▽": ["Correct dropdown for stringing selected",
                                "Correct number of modules per string",
                                "Tag number corresponds with the correct tags in Conductor details",
                                "Accurate number of wires in the line diagram and conductor details",
                                "All new equipment shown in Equipment Schedule",
                                "Correct Main Panel type and ratings",
                                "Correct AC disconnect type and rating used",
                                "Correct meter number",
                                "Correct OCPD size",
                            ],
            "ELECTRICAL CALCULATIONS ▽": ["Verify all calculations populated correctly", 
                                "All wire sizes populated correctly",
                                "Correct Ambient Temp shown",
                                "Correct module and inverter shown",
                            ],
            "LABELS ▽": ["Select the correct AHJ Labels",
                            "Verify the labels match what is shown on the plans"
                        ],
            "PLACARD ▽": ["Check for correct placard details",
                            "Ensure placard matches the approved AHJ placard"],
            "PHOTOS ▽": ["Ensure all photos show up clearly in the PDF",
                            "Ensure photos are labeled correctly"],
            "SPEC SHEETS AND ADDITIONAL DOCUMENTS ▽": ["Verify all required spec sheets are included in the checklist",
                                                        "Ensure all additional documents are included"
                                                        ]
        };
        
        function updateChecklist() {
            const fixedChecklist = document.getElementById('fixed-checklist-list');
            const fixedItems = ['COVER SHEET ▽',
                                'SITE PLAN ▽', 
                                'ROOF PLAN ▽', 
                                'MOUNTING DETAIL ▽',
                                'LINE DIAGRAM ▽',
                                'ELECTRICAL CALCULATIONS ▽',
                                'LABELS ▽',
                                'PLACARD ▽',
                                'PHOTOS ▽',
                                'SPEC SHEETS AND ADDITIONAL DOCUMENTS ▽',
                               ];

            fixedChecklist.innerHTML = '';

            fixedItems.forEach(itemText => {
                const itemElement = document.createElement('li');
                itemElement.className = 'checklist-item';
                itemElement.textContent = itemText;

                const subItemsContainer = document.createElement('div');
                subItemsContainer.className = 'sub-items';

                itemTexts[itemText].forEach(text => {
                    if (itemTexts[text]) {
                        const nestedContainer = document.createElement('div');
                        nestedContainer.style.paddingLeft = '20px';
                        itemTexts[text].forEach(nestedText => {
                            const nestedTextElement = document.createElement('div');
                            nestedTextElement.className = 'sub-item';
                            nestedTextElement.innerHTML = `
                                <label>
                                    <input type="checkbox"> ${nestedText}
                                </label>
                            `;
                            nestedContainer.appendChild(nestedTextElement);
                        });
                        const additionalTextElement = document.createElement('div');
                        additionalTextElement.className = 'sub-item';
                        additionalTextElement.textContent = text;
                        subItemsContainer.appendChild(additionalTextElement);
                        subItemsContainer.appendChild(nestedContainer);
                    } else {
                        const additionalTextElement = document.createElement('div');
                        additionalTextElement.className = 'sub-item';
                        additionalTextElement.innerHTML = `
                            <label>
                                <input type="checkbox"> ${text}
                            </label>
                        `;
                        subItemsContainer.appendChild(additionalTextElement);
                    }
                });

                itemElement.appendChild(subItemsContainer);
                fixedChecklist.appendChild(itemElement);

                itemElement.addEventListener('click', (event) => {
                    if (!event.target.closest('.sub-item')) {
                        const subItems = itemElement.querySelector('.sub-items');
                        subItems.style.display = subItems.style.display === 'none' ? 'block' : 'none';
                    }
                });
            });
        }

        function updatePreferences() {
            const upgradesList = document.getElementById('automatic-upgrades-list');
            const upgrades = ['Federal Pacific', 'Zinsco', 'Pushmatic', 'Pancake Meter'];

            upgradesList.innerHTML = '';
            upgrades.forEach(upgrade => {
                const listItem = document.createElement('li');
                listItem.textContent = upgrade;
                upgradesList.appendChild(listItem);
            });
        }

        function updateAHJOptions() {
            const stateDropdown = document.getElementById('state-dropdown');
            const ahjDropdown = document.getElementById('ahj-dropdown');
            
            const ahjOptions = {
                'California': ['Los Angeles City',
                                'Los Angeles County',
                                'Bakersfield',
                               ],
                'Texas': ['Houston'],
                'Illinois': ['Galesburg']
            };
            
            stateDropdown.addEventListener('change', () => {
                const selectedState = stateDropdown.value;
                const options = ahjOptions[selectedState] || [];
                
                ahjDropdown.innerHTML = '<option value="">Select AHJ</option>';
                options.forEach(option => {
                    const optionElement = document.createElement('option');
                    optionElement.value = option;
                    optionElement.textContent = option;
                    ahjDropdown.appendChild(optionElement);
                });

                updateUtilityOptions(selectedState);  // Update Utility options based on selected state
            });
        }

        function updateUtilityOptions(state) {
            const utilityDropdown = document.getElementById('utility-dropdown');
            
            const utilityOptions = {
                'California': ['SCE',
                                'PG&E',
                                'SDG&E',
                               ],
                'Texas': ['Oncor'],
                'Illinois': ['Amerin']
            };
            
            const options = utilityOptions[state] || [];
            
            utilityDropdown.innerHTML = '<option value="">Select Utility</option>';
            options.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                optionElement.textContent = option;
                utilityDropdown.appendChild(optionElement);
            });
        }

  function handleTrenchingCheckbox() {
    const trenchingCheckbox = document.getElementById('trenching');
    const sitePlanItem = Array.from(document.querySelectorAll('li.checklist-item')).find(item => item.textContent.includes("SITE PLAN ▽"));
    const lineDiagramItem = Array.from(document.querySelectorAll('li.checklist-item')).find(item => item.textContent.includes("LINE DIAGRAM ▽"));

    if (!trenchingCheckbox || !sitePlanItem || !lineDiagramItem) return;

    trenchingCheckbox.addEventListener('change', () => {
        const sitePlanSubItemsContainer = sitePlanItem.querySelector('.sub-items');
        const lineDiagramSubItemsContainer = lineDiagramItem.querySelector('.sub-items');
        
        if (trenchingCheckbox.checked) {
            const sitePlanNewItems = [
                'Call out length of Trench on site plan and ELD',
                'Round Trench distance to the nearest 10’',
                'First consider SS trench per homeowners request',
                'If SS does not specify run conduit directly to the MSP unless there is concrete, then we can run to the house if necessary.'
            ];

            sitePlanNewItems.forEach(text => {
                const newItem = document.createElement('div');
                newItem.className = 'sub-item green-highlight'; // Apply green-highlight class
                newItem.innerHTML = `<label><input type="checkbox"> ${text}</label>`;
                sitePlanSubItemsContainer.appendChild(newItem);
            });

            const lineDiagramNewItems = [
                'Always design wire size for less than 2% voltage drop in trench (Call this out on plans)',
                'Refer to Tech Brief for Enphase voltage drop.'
            ];

            lineDiagramNewItems.forEach(text => {
                const newItem = document.createElement('div');
                newItem.className = 'sub-item green-highlight'; // Apply green-highlight class
                newItem.innerHTML = `<label><input type="checkbox"> ${text}</label>`;
                lineDiagramSubItemsContainer.appendChild(newItem);
            });
        } else {
            const sitePlanItemsToRemove = [
                'Call out length of Trench on site plan and ELD',
                'Round Trench distance to the nearest 10’',
                'First consider SS trench per homeowners request',
                'If SS does not specify run conduit directly to the MSP unless there is concrete, then we can run to the house if necessary.'
            ];

            sitePlanItemsToRemove.forEach(text => {
                const itemToRemove = Array.from(sitePlanSubItemsContainer.querySelectorAll('.sub-item')).find(subItem => subItem.textContent.includes(text));
                if (itemToRemove) {
                    sitePlanSubItemsContainer.removeChild(itemToRemove);
                }
            });

            const lineDiagramItemsToRemove = [
                'Always design wire size for less than 2% voltage drop in trench (Call this out on plans)',
                'Refer to Tech Brief for Enphase voltage drop.'
            ];

            lineDiagramItemsToRemove.forEach(text => {
                const itemToRemove = Array.from(lineDiagramSubItemsContainer.querySelectorAll('.sub-item')).find(subItem => subItem.textContent.includes(text));
                if (itemToRemove) {
                    lineDiagramSubItemsContainer.removeChild(itemToRemove);
                }
            });
        }
    });
}
function handleGroundMountCheckbox() {
    const groundMountCheckbox = document.getElementById('ground-mount');
    const sitePlanItem = Array.from(document.querySelectorAll('li.checklist-item')).find(item => item.textContent.includes("SITE PLAN ▽"));

    if (!groundMountCheckbox || !sitePlanItem) return;

    groundMountCheckbox.addEventListener('change', () => {
        const sitePlanSubItemsContainer = sitePlanItem.querySelector('.sub-items');

        if (groundMountCheckbox.checked) {
            const groundMountNewItems = [
                'Always run the IronRidge configurator for 2” piping.',
                'Landscape orientation',
                'Design for 10’ clearance on all sides unless AHJ allows for more/less clearance.'
            ];

            groundMountNewItems.forEach(text => {
                const newItem = document.createElement('div');
                newItem.className = 'sub-item green-highlight'; // Apply green-highlight class
                newItem.innerHTML = `<label><input type="checkbox"> ${text}</label>`;
                sitePlanSubItemsContainer.appendChild(newItem);
            });
        } else {
            const groundMountItemsToRemove = [
                'Always run the IronRidge configurator for 2” piping.',
                'Landscape orientation',
                'Design for 10’ clearance on all sides unless AHJ allows for more/less clearance.'
            ];

            groundMountItemsToRemove.forEach(text => {
                const itemToRemove = Array.from(sitePlanSubItemsContainer.querySelectorAll('.sub-item')).find(subItem => subItem.textContent.includes(text));
                if (itemToRemove) {
                    sitePlanSubItemsContainer.removeChild(itemToRemove);
                }
            });
        }
    });
}




        updateChecklist();
        updatePreferences();
        updateAHJOptions();
        handleTrenchingCheckbox();
        handleGroundMountCheckbox(); 

        document.getElementById('toggle-theme').addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            document.body.classList.toggle('light-mode');
            const button = document.getElementById('toggle-theme');
            if (document.body.classList.contains('dark-mode')) {
                button.textContent = 'Light Mode';
                button.classList.remove('light-mode-btn');
            } else {
                button.textContent = 'Dark Mode';
                button.classList.add('light-mode-btn');
            }
        });
    });
</script>

</body>
</html>
